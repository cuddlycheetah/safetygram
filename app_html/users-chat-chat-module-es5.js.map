{"version":3,"sources":["./src/app/message/forwardinfo/forwardinfo.component.html","./src/app/message/message.component.html","./src/app/users/chat/chat.page.html","./src/app/message/forwardinfo/forwardinfo.component.scss","./src/app/message/forwardinfo/forwardinfo.component.ts","./src/app/message/message.component.scss","./src/app/message/message.component.ts","./src/app/users/chat/chat.module.ts","./src/app/users/chat/chat.page.scss","./src/app/users/chat/chat.page.ts"],"names":[],"mappings":"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","file":"users-chat-chat-module-es5.js","sourcesContent":["module.exports = \"<p>\\n  {{ text }}\\n</p>\"","module.exports = \"<div class=\\\"message\\\">\\n  <mat-card [attr.data-outgoing]=\\\"message.isOutgoing\\\" [attr.data-deleted]=\\\"message.deleted\\\">\\n    <!--* Title -->\\n    <mat-card-subtitle>\\n      <forward-info *ngIf=\\\"message.isForwarded === true\\\" [message]=\\\"message\\\"></forward-info>\\n    </mat-card-subtitle>\\n    <!--* Content -->\\n    <mat-card-content *ngIf=\\\"message.type=='ukn'\\\">{{ message.content | json }}</mat-card-content>\\n    <mat-card-content *ngIf=\\\"message.type=='txt'\\\">{{ message.content }}</mat-card-content>\\n    <mat-card-content *ngIf=\\\"message.type=='stk'\\\"><img [src]=\\\"'/api/file/fetch/' + message.content[0]\\\"></mat-card-content>\\n    <mat-card-content *ngIf=\\\"message.type=='pic'\\\"><img [src]=\\\"'/api/file/fetch/' + message.content[1]\\\">{{ message.content[0] }}</mat-card-content>\\n    <mat-card-content *ngIf=\\\"message.type=='gif'\\\"><img [src]=\\\"'/api/file/fetch/' + message.content[1]\\\">{{ message.content[3] }}</mat-card-content>\\n    <mat-card-content *ngIf=\\\"message.type=='gif_'\\\">\\n      <video autoplay loop [poster]=\\\"'/api/file/fetch/' + message.content[1]\\\" [src]=\\\"'/api/file/clientfetch/' + message.content[2]\\\"></video>\\n      <pre>{{ message.content[3] }}</pre>\\n    </mat-card-content>\\n    <mat-card-content *ngIf=\\\"message.hasEdits\\\" [hidden]=\\\"editsHidden\\\">\\n      <mat-list dense>\\n        <mat-list-item *ngFor=\\\"let edit of edits\\\">\\n            <p *ngIf=\\\"message.type=='txt'\\\">{{ edit.content }}</p>\\n            <p *ngIf=\\\"message.type=='pic'\\\">{{ edit.content[1] || edit.content }}</p>\\n            <p *ngIf=\\\"message.type=='ukn'\\\">{{ edit.content }}</p>\\n          <span class=\\\"msgDate\\\">{{ formatDate(edit.createdAt) }}</span>\\n        </mat-list-item>\\n      </mat-list>\\n    </mat-card-content>\\n    <!--* Footer-->\\n    <mat-card-footer>\\n      <!--* Text -->\\n      <span class=\\\"dateColumn\\\">\\n        <span class=\\\"msgDate\\\">{{ formatDate(message.createdAt) }}</span>\\n        <span class=\\\"msgDate\\\" *ngIf=\\\"message.deleted\\\">\\n          <mat-icon>delete</mat-icon>{{ formatDate(message.deletedAt) }}\\n        </span>\\n      </span>\\n      <!--* Context Menu Button -->\\n      <button mat-icon-button [mat-menu-trigger-for]=\\\"menu\\\" (menuOpened)=\\\"openedContextMenu()\\\">\\n        <mat-icon>more_vert</mat-icon>\\n      </button>\\n    </mat-card-footer>\\n    <mat-card-actions> <!--  *ngIf=\\\"message.hasEdits\\\" -->\\n      <button mat-button *ngIf=\\\"message.hasEdits\\\" (click)=\\\"toggleEdits()\\\">Edits</button>\\n    </mat-card-actions>\\n  </mat-card>\\n</div>\"","module.exports = \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-button (click)=\\\"location.back()\\\" >\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"arrow-round-back\\\"></ion-icon>\\n      </ion-button>\\n    </ion-buttons>\\n    <mat-list>\\n      <mat-list-item>\\n        <img matListAvatar *ngIf=\\\"basicChatNamesets.length > 0\\\" [src]=\\\"'/api/file/fetch/' + basicChatNamesets[0].photo\\\">\\n        <h2 matLine *ngIf=\\\"basicUserNamesets.length > 0\\\">{{ basicUserNamesets[0].firstName }} {{ basicUserNamesets[0].lastName }}</h2>\\n        <p matLine *ngIf=\\\"basicUserInfos.length > 0\\\">{{ basicUserInfos[0].bio }}</p>\\n        <!--\\n          <button mat-raised-button color=\\\"primary\\\" (click)=\\\"showInfo=!showInfo\\\">\\n            <mat-icon>history</mat-icon> {{ 'chat.message.history' | translate }}\\n          </button>\\n        -->\\n      </mat-list-item>\\n    </mat-list>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content fullscreen style=\\\"top:0;left:0;width:100%; height: 100%; background: url('/assets/background.jpg') no-repeat center center scroll;background-size: cover;\\\">\\n  <div id=\\\"chatContent\\\">\\n    <mat-tab-group backgroundColor=\\\"primary\\\" [(selectedIndex)]=\\\"selectedIndex\\\">\\n      <mat-tab>\\n        <ng-template mat-tab-label>\\n          <mat-icon>chat</mat-icon> {{ 'chat.infos.chat' | translate }}\\n        </ng-template>\\n      </mat-tab>\\n      <mat-tab>\\n        <ng-template mat-tab-label>\\n          <mat-icon>person</mat-icon> {{ 'chat.infos.identities' | translate }}\\n        </ng-template>\\n      </mat-tab>\\n      <mat-tab>\\n        <ng-template mat-tab-label>\\n          <mat-icon>bug_report</mat-icon> {{ 'chat.infos.debug' | translate }}\\n        </ng-template>\\n      </mat-tab>\\n    </mat-tab-group>\\n    <!-- Chat History -->\\n    <section class=\\\"chatTab\\\" [hidden]=\\\"selectedIndex != 0\\\">\\n      <ion-content>\\n        <ion-infinite-scroll threshold=\\\"100px\\\" position=\\\"top\\\" (ionInfinite)=\\\"loadData($event)\\\" #scroll>\\n          <ion-infinite-scroll-content loadingSpinner=\\\"bubbles\\\" loadingText=\\\"Loading more data...\\\">\\n          </ion-infinite-scroll-content>\\n        </ion-infinite-scroll>\\n        <app-message [message]=\\\"message\\\" [menu]=\\\"appMenu\\\" (menuOpened)=\\\"menuOpened($event)\\\" *ngFor=\\\"let message of cachedData\\\"></app-message>\\n      </ion-content>\\n    </section>\\n    <mat-menu #appMenu=\\\"matMenu\\\" yPosition=\\\"above\\\">\\n      <ng-template matMenuContent>\\n        <!--\\n          <button mat-menu-item translate (click)=\\\"ctxMenu_OpenInTG()\\\">\\n            chat.message.menu.openintg\\n          </button>\\n        -->\\n      </ng-template>\\n    </mat-menu>\\n    <!-- Identities -->\\n    <section class=\\\"chatTab\\\" [hidden]=\\\"selectedIndex != 1\\\">\\n      <h2 translate>chat.infos.identities</h2>\\n      <mat-list>\\n        <mat-list-item *ngFor=\\\"let chatNameset of basicChatNamesets\\\">\\n          <img matListAvatar [src]=\\\"'/api/file/fetch/' + chatNameset.photo\\\">\\n          <h3 matLine>{{ chatNameset.name }}</h3>\\n          <p matLine>\\n            <span>{{ formatDate(chatNameset.createdAt) }}</span>\\n          </p>\\n        </mat-list-item>\\n      </mat-list>\\n    </section>\\n    <!-- Debug -->\\n    <section class=\\\"chatTab\\\" [hidden]=\\\"selectedIndex != 2\\\">\\n      <pre>{{ basicUser | json }}</pre>\\n      <pre>{{ basicUserInfos | json }}</pre>\\n      <pre>{{ basicUserNamesets | json }}</pre>\\n      <pre>{{ basicChatNamesets | json }}</pre>\\n    </section>\\n  </div>\\n</ion-content>\\n\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL21lc3NhZ2UvZm9yd2FyZGluZm8vZm9yd2FyZGluZm8uY29tcG9uZW50LnNjc3MifQ== */\"","import { Component, OnInit, Input } from '@angular/core';\nimport { TranslateService } from '@ngx-translate/core';\nimport { HttpClient } from '@angular/common/http';\n\n@Component({\n  selector: 'forward-info',\n  templateUrl: './forwardinfo.component.html',\n  styleUrls: ['./forwardinfo.component.scss'],\n})\nexport class ForwardinfoComponent implements OnInit {\n\n  @Input()\n  public message;\n\n  public text = 'Unkown';\n  constructor(\n    public translate: TranslateService,\n    public http: HttpClient\n  ) { }\n\n  ngOnInit() {\n    /*\n      fordwardName: \"\"\n      forwardInfo: null\n      forwardType: null\n      forwardedChat: -1001211391560\n      forwardedUser: null\n    */\n   const peerId = !!this.message.forwardedUser ? this.message.forwardedUser : this.message.forwardedChat;\n\n   this.http.get(`/api/rest/chatnameset/desc?chatId=${ peerId }`)\n   .subscribe((data: any) => {\n    const peerName = !!this.message.fordwardName && this.message.fordwardName.length > 0\n      ? this.message.fordwardName\n      : data[0].name;\n\n    if (!!this.message.forwardedChat) {\n      this.text = `${ this.translate.instant('chat.message.forwardinfo.chat') } ${ peerName }`;\n    }\n    if (!!this.message.forwardedUser) {\n      this.text = `${ this.translate.instant('chat.message.forwardinfo.user') } ${ peerName }`;\n    }\n   });\n  }\n\n}\n","module.exports = \"mat-card {\\n  max-width: 300px;\\n  width: 80%;\\n  padding-top: 5px;\\n  color: white;\\n}\\n\\nmat-card[data-outgoing=false] {\\n  background-color: #182533;\\n}\\n\\nmat-card[data-outgoing=true] {\\n  margin-left: auto;\\n  background-color: #2B5278;\\n}\\n\\nmat-card[data-deleted=true] {\\n  background-color: maroon;\\n}\\n\\n.message {\\n  width: 100%;\\n  display: block;\\n  padding-left: 1.75rem;\\n  padding-right: 1.75rem;\\n  padding-top: 0.75rem;\\n  padding-bottom: 1rem;\\n}\\n\\nmat-card-subtitle {\\n  color: white;\\n}\\n\\nmat-card-subtitle > forward-info {\\n  color: white;\\n  font-weight: bold;\\n}\\n\\nmat-card-footer {\\n  display: -webkit-box;\\n  display: flex;\\n  -webkit-box-orient: horizontal;\\n  -webkit-box-direction: normal;\\n          flex-direction: row;\\n  -webkit-box-pack: justify;\\n          justify-content: space-between;\\n  color: white;\\n}\\n\\nmat-card-footer > mat-icon {\\n  font-size: 0.95rem !important;\\n}\\n\\nmat-card[data-outgoing=false] mat-card-footer span {\\n  -webkit-box-ordinal-group: 1;\\n          order: 0;\\n}\\n\\nmat-card[data-outgoing=true] mat-card-footer span {\\n  -webkit-box-ordinal-group: 2;\\n          order: 1;\\n}\\n\\nmat-card[data-outgoing=false] mat-card-footer button {\\n  -webkit-box-ordinal-group: 2;\\n          order: 1;\\n}\\n\\nmat-card[data-outgoing=true] mat-card-footer button {\\n  -webkit-box-ordinal-group: 1;\\n          order: 0;\\n}\\n\\n.msgDate {\\n  padding-left: 0.2rem;\\n  padding-right: 0.2rem;\\n  font-size: 1.2rem;\\n  font-family: monospace;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbWVzc2FnZS9NOlxccHJvamVjdHNcXHNhZmV0eWdyYW1hcHBcXHNmYWV0eWdyYW1hcHAvc3JjXFxhcHBcXG1lc3NhZ2VcXG1lc3NhZ2UuY29tcG9uZW50LnNjc3MiLCJzcmMvYXBwL21lc3NhZ2UvbWVzc2FnZS5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGdCQUFBO0VBQ0EsVUFBQTtFQUNBLGdCQUFBO0VBQ0EsWUFBQTtBQ0NKOztBRENBO0VBQ0kseUJBQUE7QUNFSjs7QURBQTtFQUNJLGlCQUFBO0VBQ0EseUJBQUE7QUNHSjs7QUREQTtFQUNJLHdCQUFBO0FDSUo7O0FEREE7RUFDSSxXQUFBO0VBQ0EsY0FBQTtFQUNBLHFCQUFBO0VBQ0Esc0JBQUE7RUFDQSxvQkFBQTtFQUNBLG9CQUFBO0FDSUo7O0FERkE7RUFDSSxZQUFBO0FDS0o7O0FESEE7RUFDSSxZQUFBO0VBQ0EsaUJBQUE7QUNNSjs7QURGQTtFQUNJLG9CQUFBO0VBQUEsYUFBQTtFQUNBLDhCQUFBO0VBQUEsNkJBQUE7VUFBQSxtQkFBQTtFQUNBLHlCQUFBO1VBQUEsOEJBQUE7RUFDQSxZQUFBO0FDS0o7O0FESEE7RUFDSSw2QkFBQTtBQ01KOztBREpBO0VBQ0ksNEJBQUE7VUFBQSxRQUFBO0FDT0o7O0FESkE7RUFDSSw0QkFBQTtVQUFBLFFBQUE7QUNPSjs7QURKQTtFQUNJLDRCQUFBO1VBQUEsUUFBQTtBQ09KOztBRExBO0VBQ0ksNEJBQUE7VUFBQSxRQUFBO0FDUUo7O0FESkE7RUFDSSxvQkFBQTtFQUNBLHFCQUFBO0VBQ0EsaUJBQUE7RUFDQSxzQkFBQTtBQ09KIiwiZmlsZSI6InNyYy9hcHAvbWVzc2FnZS9tZXNzYWdlLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsibWF0LWNhcmQge1xyXG4gICAgbWF4LXdpZHRoOiAzMDBweDtcclxuICAgIHdpZHRoOiA4MCU7XHJcbiAgICBwYWRkaW5nLXRvcDogNXB4O1xyXG4gICAgY29sb3I6IHdoaXRlO1xyXG59XHJcbm1hdC1jYXJkW2RhdGEtb3V0Z29pbmc9J2ZhbHNlJ10ge1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogIzE4MjUzMztcclxufVxyXG5tYXQtY2FyZFtkYXRhLW91dGdvaW5nPSd0cnVlJ10ge1xyXG4gICAgbWFyZ2luLWxlZnQ6IGF1dG87XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMkI1Mjc4O1xyXG59XHJcbm1hdC1jYXJkW2RhdGEtZGVsZXRlZD0ndHJ1ZSddIHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYigxMjgsIDAsIDApO1xyXG59XHJcblxyXG4ubWVzc2FnZSB7XHJcbiAgICB3aWR0aDogMTAwJTtcclxuICAgIGRpc3BsYXk6IGJsb2NrO1xyXG4gICAgcGFkZGluZy1sZWZ0OiAxLjc1cmVtO1xyXG4gICAgcGFkZGluZy1yaWdodDogMS43NXJlbTtcclxuICAgIHBhZGRpbmctdG9wOiAwLjc1cmVtO1xyXG4gICAgcGFkZGluZy1ib3R0b206IDFyZW07XHJcbn1cclxubWF0LWNhcmQtc3VidGl0bGUge1xyXG4gICAgY29sb3I6IHdoaXRlO1xyXG59XHJcbm1hdC1jYXJkLXN1YnRpdGxlID4gZm9yd2FyZC1pbmZvIHtcclxuICAgIGNvbG9yOiB3aGl0ZTtcclxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xyXG59XHJcblxyXG4vLyBGb290ZXIgU3R1ZmZcclxubWF0LWNhcmQtZm9vdGVyIHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xyXG4gICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xyXG4gICAgY29sb3I6IHdoaXRlO1xyXG59XHJcbm1hdC1jYXJkLWZvb3RlciA+IG1hdC1pY29uIHtcclxuICAgIGZvbnQtc2l6ZTogMC45NXJlbSAhaW1wb3J0YW50O1xyXG59XHJcbm1hdC1jYXJkW2RhdGEtb3V0Z29pbmc9J2ZhbHNlJ10gbWF0LWNhcmQtZm9vdGVyIHNwYW4ge1xyXG4gICAgb3JkZXI6IDA7XHJcbiAgICAvLyB0ZXh0LWFsaWduOiByaWdodDtcclxufVxyXG5tYXQtY2FyZFtkYXRhLW91dGdvaW5nPSd0cnVlJ10gbWF0LWNhcmQtZm9vdGVyIHNwYW4ge1xyXG4gICAgb3JkZXI6IDE7XHJcbiAgICAvLyB0ZXh0LWFsaWduOiBsZWZ0O1xyXG59XHJcbm1hdC1jYXJkW2RhdGEtb3V0Z29pbmc9J2ZhbHNlJ10gbWF0LWNhcmQtZm9vdGVyIGJ1dHRvbiB7XHJcbiAgICBvcmRlcjogMTtcclxufVxyXG5tYXQtY2FyZFtkYXRhLW91dGdvaW5nPSd0cnVlJ10gbWF0LWNhcmQtZm9vdGVyIGJ1dHRvbiB7XHJcbiAgICBvcmRlcjowO1xyXG59XHJcblxyXG4vLyBEYXRlXHJcbi5tc2dEYXRlIHtcclxuICAgIHBhZGRpbmctbGVmdDogMC4ycmVtO1xyXG4gICAgcGFkZGluZy1yaWdodDogMC4ycmVtO1xyXG4gICAgZm9udC1zaXplOiAxLjJyZW07XHJcbiAgICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xyXG59IiwibWF0LWNhcmQge1xuICBtYXgtd2lkdGg6IDMwMHB4O1xuICB3aWR0aDogODAlO1xuICBwYWRkaW5nLXRvcDogNXB4O1xuICBjb2xvcjogd2hpdGU7XG59XG5cbm1hdC1jYXJkW2RhdGEtb3V0Z29pbmc9ZmFsc2VdIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogIzE4MjUzMztcbn1cblxubWF0LWNhcmRbZGF0YS1vdXRnb2luZz10cnVlXSB7XG4gIG1hcmdpbi1sZWZ0OiBhdXRvO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjMkI1Mjc4O1xufVxuXG5tYXQtY2FyZFtkYXRhLWRlbGV0ZWQ9dHJ1ZV0ge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiBtYXJvb247XG59XG5cbi5tZXNzYWdlIHtcbiAgd2lkdGg6IDEwMCU7XG4gIGRpc3BsYXk6IGJsb2NrO1xuICBwYWRkaW5nLWxlZnQ6IDEuNzVyZW07XG4gIHBhZGRpbmctcmlnaHQ6IDEuNzVyZW07XG4gIHBhZGRpbmctdG9wOiAwLjc1cmVtO1xuICBwYWRkaW5nLWJvdHRvbTogMXJlbTtcbn1cblxubWF0LWNhcmQtc3VidGl0bGUge1xuICBjb2xvcjogd2hpdGU7XG59XG5cbm1hdC1jYXJkLXN1YnRpdGxlID4gZm9yd2FyZC1pbmZvIHtcbiAgY29sb3I6IHdoaXRlO1xuICBmb250LXdlaWdodDogYm9sZDtcbn1cblxubWF0LWNhcmQtZm9vdGVyIHtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xuICBjb2xvcjogd2hpdGU7XG59XG5cbm1hdC1jYXJkLWZvb3RlciA+IG1hdC1pY29uIHtcbiAgZm9udC1zaXplOiAwLjk1cmVtICFpbXBvcnRhbnQ7XG59XG5cbm1hdC1jYXJkW2RhdGEtb3V0Z29pbmc9ZmFsc2VdIG1hdC1jYXJkLWZvb3RlciBzcGFuIHtcbiAgb3JkZXI6IDA7XG59XG5cbm1hdC1jYXJkW2RhdGEtb3V0Z29pbmc9dHJ1ZV0gbWF0LWNhcmQtZm9vdGVyIHNwYW4ge1xuICBvcmRlcjogMTtcbn1cblxubWF0LWNhcmRbZGF0YS1vdXRnb2luZz1mYWxzZV0gbWF0LWNhcmQtZm9vdGVyIGJ1dHRvbiB7XG4gIG9yZGVyOiAxO1xufVxuXG5tYXQtY2FyZFtkYXRhLW91dGdvaW5nPXRydWVdIG1hdC1jYXJkLWZvb3RlciBidXR0b24ge1xuICBvcmRlcjogMDtcbn1cblxuLm1zZ0RhdGUge1xuICBwYWRkaW5nLWxlZnQ6IDAuMnJlbTtcbiAgcGFkZGluZy1yaWdodDogMC4ycmVtO1xuICBmb250LXNpemU6IDEuMnJlbTtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn0iXX0= */\"","import { Component, OnInit, Input, EventEmitter, Output } from '@angular/core';\nimport { Message, MessageEdit } from '../users/chat/chat.page';\nimport { HttpClient } from '@angular/common/http';\nimport { MatMenu } from '@angular/material';\n\n@Component({\n  selector: 'app-message',\n  templateUrl: './message.component.html',\n  styleUrls: ['./message.component.scss'],\n})\nexport class MessageComponent implements OnInit {\n\n  @Input()\n  public message: Message;\n\n  @Input()\n  public menu: MatMenu;\n\n  @Output()\n  public menuOpened = new EventEmitter();\n\n  edits: MessageEdit[] = [];\n  editsHidden = true;\n\n  constructor(\n    private http: HttpClient,\n  ) { }\n\n  ngOnInit() {}\n\n  openedContextMenu() {\n    console.log(this.message);\n    this.menuOpened.emit(this.message);\n  }\n  toggleEdits () {\n    if (this.message.hasEdits) {\n      if (this.edits.length === 0) {\n        return this.http.get(`/api/rest/messageedit/?messageId=${ this.message.id }`)\n        .subscribe((res: MessageEdit[]) => {\n          console.log('res', res.length);\n          this.edits = res;\n        });\n      }\n      this.editsHidden = !this.editsHidden;\n    }\n  }\n  formatDate (inputDate: Date) {\n    const date = new Date(inputDate);\n    return `${ date.toLocaleDateString() } ${ date.toLocaleTimeString() }`;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ChatPage } from './chat.page';\nimport { MaterialModule } from 'src/app/material.module';\nimport { MessageComponent } from 'src/app/message/message.component';\nimport { ForwardinfoComponent } from 'src/app/message/forwardinfo/forwardinfo.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ChatPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes),\n    MaterialModule\n  ],\n  declarations: [\n    ChatPage,\n    MessageComponent,\n    ForwardinfoComponent\n  ]\n})\nexport class ChatPageModule {}\n","module.exports = \"#chatContent {\\n  display: -webkit-box;\\n  display: flex;\\n  -webkit-box-orient: vertical;\\n  -webkit-box-direction: normal;\\n          flex-direction: column;\\n  height: 100%;\\n}\\n\\n.chatTab {\\n  background: url(\\\"/assets/background.jpg\\\") no-repeat center center fixed;\\n  background-size: cover;\\n  height: 100%;\\n  background-size: cover;\\n  /* height: 100%; */\\n  /* max-height: 100%; */\\n  /* display: block; */\\n  overflow: hidden;\\n  overflow-y: scroll;\\n}\\n\\n/* width */\\n\\n::-webkit-scrollbar {\\n  width: 10px;\\n}\\n\\n/* Track */\\n\\n::-webkit-scrollbar-track {\\n  background: #f1f1f1;\\n}\\n\\n/* Handle */\\n\\n::-webkit-scrollbar-thumb {\\n  background: #888;\\n}\\n\\n/* Handle on hover */\\n\\n::-webkit-scrollbar-thumb:hover {\\n  background: #555;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdXNlcnMvY2hhdC9NOlxccHJvamVjdHNcXHNhZmV0eWdyYW1hcHBcXHNmYWV0eWdyYW1hcHAvc3JjXFxhcHBcXHVzZXJzXFxjaGF0XFxjaGF0LnBhZ2Uuc2NzcyIsInNyYy9hcHAvdXNlcnMvY2hhdC9jaGF0LnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLG9CQUFBO0VBQUEsYUFBQTtFQUNBLDRCQUFBO0VBQUEsNkJBQUE7VUFBQSxzQkFBQTtFQUNBLFlBQUE7QUNDSjs7QURDQTtFQUNJLHVFQUFBO0VBQXdFLHNCQUFBO0VBQ3hFLFlBQUE7RUFDQSxzQkFBQTtFQUNBLGtCQUFBO0VBQ0Esc0JBQUE7RUFDQSxvQkFBQTtFQUNBLGdCQUFBO0VBQ0Esa0JBQUE7QUNHSjs7QURBQSxVQUFBOztBQUNBO0VBQ0ksV0FBQTtBQ0dKOztBRERBLFVBQUE7O0FBQ0E7RUFDSSxtQkFBQTtBQ0lKOztBREZBLFdBQUE7O0FBQ0E7RUFDSSxnQkFBQTtBQ0tKOztBREhBLG9CQUFBOztBQUNBO0VBQ0ksZ0JBQUE7QUNNSiIsImZpbGUiOiJzcmMvYXBwL3VzZXJzL2NoYXQvY2hhdC5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjY2hhdENvbnRlbnQge1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAgICBoZWlnaHQ6IDEwMCU7XHJcbn1cclxuLmNoYXRUYWIge1xyXG4gICAgYmFja2dyb3VuZDogdXJsKCcvYXNzZXRzL2JhY2tncm91bmQuanBnJykgbm8tcmVwZWF0IGNlbnRlciBjZW50ZXIgZml4ZWQ7YmFja2dyb3VuZC1zaXplOiBjb3ZlcjtcclxuICAgIGhlaWdodDogMTAwJTtcclxuICAgIGJhY2tncm91bmQtc2l6ZTogY292ZXI7XHJcbiAgICAvKiBoZWlnaHQ6IDEwMCU7ICovXHJcbiAgICAvKiBtYXgtaGVpZ2h0OiAxMDAlOyAqL1xyXG4gICAgLyogZGlzcGxheTogYmxvY2s7ICovXHJcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gICAgb3ZlcmZsb3cteTogc2Nyb2xsO1xyXG59XHJcblxyXG4vKiB3aWR0aCAqL1xyXG46Oi13ZWJraXQtc2Nyb2xsYmFyIHtcclxuICAgIHdpZHRoOiAxMHB4O1xyXG59XHJcbi8qIFRyYWNrICovXHJcbjo6LXdlYmtpdC1zY3JvbGxiYXItdHJhY2sge1xyXG4gICAgYmFja2dyb3VuZDogI2YxZjFmMTsgXHJcbn1cclxuLyogSGFuZGxlICovXHJcbjo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWIge1xyXG4gICAgYmFja2dyb3VuZDogIzg4ODsgXHJcbn1cclxuLyogSGFuZGxlIG9uIGhvdmVyICovXHJcbjo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6aG92ZXIge1xyXG4gICAgYmFja2dyb3VuZDogIzU1NTsgXHJcbn0iLCIjY2hhdENvbnRlbnQge1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICBoZWlnaHQ6IDEwMCU7XG59XG5cbi5jaGF0VGFiIHtcbiAgYmFja2dyb3VuZDogdXJsKFwiL2Fzc2V0cy9iYWNrZ3JvdW5kLmpwZ1wiKSBuby1yZXBlYXQgY2VudGVyIGNlbnRlciBmaXhlZDtcbiAgYmFja2dyb3VuZC1zaXplOiBjb3ZlcjtcbiAgaGVpZ2h0OiAxMDAlO1xuICBiYWNrZ3JvdW5kLXNpemU6IGNvdmVyO1xuICAvKiBoZWlnaHQ6IDEwMCU7ICovXG4gIC8qIG1heC1oZWlnaHQ6IDEwMCU7ICovXG4gIC8qIGRpc3BsYXk6IGJsb2NrOyAqL1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICBvdmVyZmxvdy15OiBzY3JvbGw7XG59XG5cbi8qIHdpZHRoICovXG46Oi13ZWJraXQtc2Nyb2xsYmFyIHtcbiAgd2lkdGg6IDEwcHg7XG59XG5cbi8qIFRyYWNrICovXG46Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrIHtcbiAgYmFja2dyb3VuZDogI2YxZjFmMTtcbn1cblxuLyogSGFuZGxlICovXG46Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHtcbiAgYmFja2dyb3VuZDogIzg4ODtcbn1cblxuLyogSGFuZGxlIG9uIGhvdmVyICovXG46Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyIHtcbiAgYmFja2dyb3VuZDogIzU1NTtcbn0iXX0= */\"","import { Component, OnInit, ViewChild } from '@angular/core';\nimport { ModalController, LoadingController, AlertController, IonInfiniteScroll } from '@ionic/angular';\nimport { HttpClient } from '@angular/common/http';\nimport { Location } from '@angular/common';\nimport { ActivatedRoute } from '@angular/router';\nimport { finalize } from 'rxjs/operators';\n\nimport { forkJoin, Subscription, BehaviorSubject, Observable } from 'rxjs';\nimport { DataSource } from '@angular/cdk/table';\nimport { CollectionViewer } from '@angular/cdk/collections';\nimport { TranslateService } from '@ngx-translate/core';\n\n@Component({\n  selector: 'app-chat',\n  templateUrl: './chat.page.html',\n  styleUrls: ['./chat.page.scss'],\n})\nexport class ChatPage implements OnInit {\n\n  id = '';\n  basicUser: any = {};\n  basicUserInfos: any[] = [];\n  basicUserNamesets: any[] = [];\n  basicChatNamesets: any[] = [];\n\n  messages: any[] = [];\n  public contextMenuMessage = {};\n\n  private PAGE_SIZE = 50;\n  selectedIndex = 0;\n  messageCount = 0;\n  cPage = 0;\n  cachedData: Message[] = [];\n\n  @ViewChild('scroll', { static: true })\n  scroll: IonInfiniteScroll;\n\n  constructor(\n    private route: ActivatedRoute,\n    public modalController: ModalController,\n    private http: HttpClient,\n    private loadingCtrl: LoadingController,\n    private alertCtrl: AlertController,\n    public location: Location,\n    private translate: TranslateService\n  ) { }\n\n  async ngOnInit() {\n    this.id = this.route.snapshot.paramMap.get('id');\n    this.loadBasicInfo();\n  }\n\n  private getPageForIndex(index: number): number {\n    return Math.floor(index / this.PAGE_SIZE);\n  }\n  public async loadPreviousPage() {\n    return this.http.get(`/api/rest/message/@page/desc/${ this.id }/${ this.cPage++ }`)\n    .subscribe((res: Message[]) => {\n      this.scroll.disabled = res.length === 0;\n      for (let message of res) {\n        message.content = JSON.parse(message.content);\n        this.cachedData.unshift(message);\n      }\n    });\n  }\n  formatDate (inputDate: Date) {\n    const date = new Date(inputDate);\n    return `${ date.toLocaleDateString() } ${ date.toLocaleTimeString() }`;\n  }\n  async loadBasicInfo() {\n    const loading = await this.loadingCtrl.create({\n      message: this.translate.instant('users.chat.loading'),\n      translucent: true,\n    });\n    await loading.present();\n    return forkJoin(\n      [\n        this.http.get(`/api/rest/user/${ this.id }`),\n        this.http.get(`/api/rest/userinfo/desc?userId=${ this.id }`),\n        this.http.get(`/api/rest/usernameset/desc?userId=${ this.id }`),\n        this.http.get(`/api/rest/chatnameset/desc?chatId=${ this.id }`),\n        this.http.get(`/api/rest/message/@count?chatId=${ this.id }`),\n      ]\n    )\n    .pipe(\n      finalize(() => loading.dismiss())\n    )\n    .subscribe(async (res: any) => {\n      this.basicUser = res[0];\n      this.basicUserInfos = res[1];\n      this.basicUserNamesets = res[2];\n      this.basicChatNamesets = res[3];\n      this.messageCount = res[4];\n      this.loadPreviousPage();\n      console.log('=> got response', res);\n    });\n  }\n  async loadData(event) {\n    event.target.disabled = true;\n    await this.loadPreviousPage();\n\n    event.target.complete();\n    event.target.disabled = false;\n  }\n\n  menuOpened (message) {\n    this.contextMenuMessage = message;\n    console.log('context menu message=', message);\n  }\n  ctxMenu_OpenInTG() {\n    // const url = `tg://openmessage?user_id=${ this.contextMenuMessage.chatId }&message_id=${ this.contextMenuMessage.id }`;\n    // window.open(url);\n  }\n}\nexport interface Message {\n  id: number;\n  chatId: number;\n  userId: number;\n  senderChatId: number;\n\n  isOutgoing: boolean;\n\n  replyToMessageId: number;\n  mediaAlbumId: string;\n\n  isForwarded: boolean;\n  forwardInfo: string;\n\n  type: string;\n  content: string;\n\n  deleted: boolean;\n  deletedAt: Date;\n  createdAt: Date;\n\n  hasEdits: boolean;\n};\nexport interface MessageEdit {\n  id: number;\n  messageId: number;\n  chatId: number;\n\n  createdAt: Date;\n  content: string;\n}"],"sourceRoot":""}